import { isSomeTotal } from "../data/dataSourceUtils";
import escape from "lodash/escape";
import { VALUE_CLASS } from "../base/constants";
import { agColId } from "../structure/tableDescriptorTypes";
function hasTotalForCurrentColumn(params) {
    var row = params.data;
    if (!row || !row.calculatedForColumns || !params.colDef) {
        return false;
    }
    var colId = agColId(params.colDef);
    return row.calculatedForColumns.some(function (col) { return col === colId; });
}
/**
 * Returns common implementation of cell renderer used for normal cells, sticky header cells and totals.
 *
 * TODO: Consider to use custom pinnerRowCellRenderer in order to reduce number of conditionals
 */
export function createCellRenderer() {
    return function (params) {
        var _a;
        var isRowTotalOrSubtotal = isSomeTotal((_a = params.data) === null || _a === void 0 ? void 0 : _a.type);
        var isActiveRowTotal = isRowTotalOrSubtotal && hasTotalForCurrentColumn(params);
        var formattedValue = isRowTotalOrSubtotal && !isActiveRowTotal && !params.value
            ? "" // inactive row total cells should be really empty (no "-") when they have no value (RAIL-1525)
            : escape(params.formatValue(params.value));
        var className = params.node.rowPinned === "top" ? "gd-sticky-header-value" : VALUE_CLASS;
        return "<span class=\"" + className + "\">" + (formattedValue || "") + "</span>";
    };
}
//# sourceMappingURL=cellRenderer.js.map