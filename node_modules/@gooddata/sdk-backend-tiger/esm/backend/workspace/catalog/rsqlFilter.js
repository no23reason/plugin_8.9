import { __assign } from "tslib";
// (C) 2021 GoodData Corporation
import { isUriRef } from "@gooddata/sdk-model";
import isEmpty from "lodash/isEmpty";
import invariant from "ts-invariant";
export function tagsToRsqlFilter(_a) {
    var includeTags = _a.includeTags, excludeTags = _a.excludeTags;
    var rsqlFilterParts = [];
    if (!isEmpty(includeTags)) {
        var includeTagsIdentifiers = tagsToIdentifiers(includeTags);
        rsqlFilterParts.push("tags=in=(" + includeTagsIdentifiers.join(",") + ")");
    }
    if (!isEmpty(excludeTags)) {
        var excludeTagsIdentifiers = tagsToIdentifiers(excludeTags);
        rsqlFilterParts.push("tags=out=(" + excludeTagsIdentifiers.join(",") + ")");
    }
    return rsqlFilterParts.join(";");
}
export function addRsqlFilterToParams(params, filter) {
    if (isEmpty(filter)) {
        return params;
    }
    return __assign(__assign({}, params), { filter: filter });
}
function tagsToIdentifiers(tags) {
    return tags.map(function (ref) {
        // Tags cannot be accessed by any separate endpoint, so it doesn't make sense to reference them by uri.
        // We will likely change the tag type signature from ObjRef to plain string in the future.
        invariant(!isUriRef(ref), "Tags cannot be referenced by uri!");
        return ref.identifier;
    });
}
//# sourceMappingURL=rsqlFilter.js.map